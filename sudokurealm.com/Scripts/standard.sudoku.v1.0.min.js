var Timer=function(){};Timer.prototype={second:0,minute:0,hour:0,paused:false,refresh:null,init:function(a){return this.el=a,this},"set":function(a){return a=a.split(":"),this.hour=a[0],this.minute=a[1],this.second=a[2],this},go:function(c){function b(){a.second++,60==a.second&&(a.second=0,a.minute++),10>a.second&&(a.second="0"+a.second),60==a.minute&&(a.minute=0,a.hour++);var b=a.hour>0?(9>=a.hour?"0"+a.hour:a.hour)+":":"";a.el.html(b+(9>=a.minute?"0"+a.minute:a.minute)+":"+a.second)}var a=this;return this.paused=false,c&&b(),window.clearInterval(this.refresh),a.refresh=window.setInterval(b,1e3),this},stop:function(){return this.paused=true,window.clearInterval(this.refresh),this},restart:function(){this.second=this.minute=this.hour=0,this.el.text("00:00"),this.stop().go()},clickEvent:function(){function c(){b&&(b=false,a.paused===false?(a.stop(),window.clearInterval(a.focus),b=true):(a.go(),b=true))}var a=this,b=true;this.el.bind("click",c)}};var texts={share:"Copy the link below to share the currently displayed board",exp:"This string represnt the board, with '0' as empty cell",imp:"Enter a string of 81 characters (blanks can be 0, or anything but a number)",import_invalid:"Your submission is invalid, please check again",board_invalid:"Invalid board: no single solution found",saveGame:"Game saved",loadGame:"Game loaded",newGame:"New game loaded",win:"You won! very impressive",loose:"Solution is not valid, please verify",pause:"Game paused",clear_cell:"Clear cell",loading_calculating:"Calculating .. Please Wait ..",undo:"Undo Performed",restart_successful:"Game Restarted Successfully ..."},options={buttons:{alertClose:$(".alert-message .close"),pause:$("#pauseButton"),restart:$("#restartButton"),confirmRestart:$("#confirmrestartButton"),highlightSimilar:$("#context-highlight"),clearCell:$("#context-clearcell"),hint:$("#hintButton"),checkSolution:$("#checkSolutionButton"),checkCell:$("#context-checkcell"),undo:$("#undoButton"),highlightNum:$(".highlightnum"),save:$("#saveButton"),load:$("#loadButton"),confirmSave:$("#confirmsaveButton"),"set":function(b,a){a=a?false:true,b.prop("disabled",a)}},switchs:{allNotes:$("#allnotesSwitch"),noteMode:$("#notemodeSwitch"),easyMode:$("#easymodeSwitch"),"set":function(a,b){a.bootstrapSwitch("setState",b)}},modals:{pause:$("#pauseModal"),restart:$("#restartModal"),save:$("#saveModal"),load:$("#loadModal"),show:function(a){a.modal("show")},hide:function(a){a.modal("hide")}},spans:{remainingSaves:$("#remainingSaveSpan"),gameId:$("#IdLiteral")},bind_options:function(){var a=this;this.switchs.set(this.switchs.easyMode,false),this.switchs.set(this.switchs.noteMode,false),this.switchs.set(this.switchs.allNotes,false),this.switchs.noteMode.on("switch-change",board.noteModeClick),this.switchs.easyMode.on("switch-change",board.easyModeClick),this.switchs.allNotes.on("switch-change",board.allCandidatesModeClick),this.buttons.alertClose.bind("click",a.alertClose),this.buttons.pause.bind("click",a.pauseGame),this.buttons.restart.bind("click",a.showRestartModel),this.buttons.confirmRestart.bind("click",a.confirmRestart),this.buttons.highlightSimilar.bind("click",a.highlightSimilar),this.buttons.clearCell.bind("click",a.clearCell),this.buttons.hint.bind("click",a.hint),this.buttons.checkSolution.bind("click",a.checkSolution),this.buttons.checkCell.bind("click",a.checkCell),this.buttons.undo.bind("click",a.undo),this.buttons.save.bind("click",a.showSaveModel),this.buttons.load.bind("click",a.showLoadModel),this.buttons.confirmSave.bind("click",a.confirmSave),this.buttons.highlightNum.bind("click",a.highlightnum),this.modals.pause.bind("hidden",a.continueGame),this.initSaveLoad()},initSaveLoad:function(){var a=board;null==a.userToken?(a.numberOfSaves=0,options.spans.remainingSaves.text(a.numberOfSaves),options.buttons.set(options.buttons.save,false),options.buttons.set(options.buttons.load,false)):$.ajax({type:"POST",url:"/Account/SudokuService.asmx/GetSaves",data:JSON.stringify({token:a.userToken,gameid:options.spans.gameId.text()}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){a.numberOfSaves=a.MaxSavesAllowed-b.d.length,options.spans.remainingSaves.text(a.numberOfSaves),options.createSaveTable(b.d),options.toggleLoadButton(),options.toggleSaveButton()},error:function(b,a){alert(a)}}),$("#saveGameTable").on("click",".deletesave",function(c){var a=board,d=$(this),e=$("#loadGameTable > tbody");$("#saveloadingimg").css("display","inline");var b=$(this).parents("tr").children("td:eq(0)").text(),f=$(this).parents("tr").index();$.ajax({type:"POST",url:"/Account/SudokuService.asmx/DeleteSaveGame",data:JSON.stringify({token:a.userToken,gameId:options.spans.gameId.text(),saveId:b}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){$("#saveloadingimg").css("display","none"),d.parents("tr").remove(),e.find("tr:eq("+f+")").remove(),a.numberOfSaves++,options.spans.remainingSaves.text(a.numberOfSaves),options.toggleSaveButton(),options.toggleLoadButton(),options.modals.hide(options.modals.save),a.alertMessage("Save Id: "+b+" deleted successfully")},error:function(c,b){$("#saveloadingimg").css("display","none"),options.modals.hide(options.modals.save),a.alertMessage("Error: "+b)}}),c.stopPropagation()}),$("#saveGameId").keypress(function(a){var b=a.keyCode?a.keyCode:a.which;if("13"==b)return options.buttons.confirmSave.click(),false})},createSaveTable:function(b){for(var e,f,g,h,i,d,c,j,k=$("#saveGameTable > tbody"),l=$("#loadGameTable > tbody"),a=0;b.length>a;a++)d=$("<tr>"),c=$("<tr>"),c.css("cursor","pointer"),e=$("<td>"),h=$("<td>"),e.text(b[a].SaveId),h.text(b[a].SaveId),d.append(e),c.append(h),f=$("<td>"),i=$("<td>"),f.text(b[a].SaveTimeStamp),i.text(b[a].SaveTimeStamp),d.append(f),c.append(i),g=$("<td>"),j=$('<button class="btn btn-mini deletesave" type="button">X</button>'),g.append(j),d.append(g),c.data("MovesHistory",b[a].MovesHistory),c.data("SaveData",b[a].SaveData),k.append(d),l.append(c)},allNotesSwitchToggle:function(c,a){var b=($(a.el),a.value);alert(b)},pauseGame:function(){var a=board;options.modals.show(options.modals.pause),a.timer.stop(),a.mainboard.fadeOut("500")},continueGame:function(){var a=board;a.mainboard.fadeIn("500"),a.timer.go()},showRestartModel:function(){options.modals.show(options.modals.restart)},confirmRestart:function(){var a=board;a.restart(),options.modals.hide(options.modals.restart),a.alertMessage(texts.restart_successful)},highlightSimilar:function(b){var a=board;a.highlightSimilarCells(a.selectedPosI,a.selectedPosJ),b.preventDefault()},clearCell:function(b){var a=board;a.clearCell(a.selectedPosI,a.selectedPosJ),b.preventDefault()},hint:function(){var a=board;a.hint()},checkSolution:function(){var a=board;a.checkSolution()},checkCell:function(b){var a=board;a.checkSolution(a.selectedPosI,a.selectedPosJ),b.preventDefault()},alertClose:function(){$(this).parent().fadeOut(200,function(){$(this).hide()})},undo:function(){var a=board;a.undo()},showSaveModel:function(){options.modals.show(options.modals.save),options.toggleSaveButton()},showLoadModel:function(){options.bindLoadClicks(),options.modals.show(options.modals.load)},toggleSaveButton:function(){var a=board;0==a.numberOfSaves?options.buttons.set(options.buttons.confirmSave,false):options.buttons.set(options.buttons.confirmSave,true)},toggleLoadButton:function(){var a=board;5==a.numberOfSaves?options.buttons.set(options.buttons.load,false):options.buttons.set(options.buttons.load,true)},confirmSave:function(){var c=board,d=$("<tr>"),a=$("<tr>"),b=new Date,f=[[utility.AddZero(b.getDate()),utility.AddZero(b.getMonth()+1),b.getFullYear()].join("/"),[utility.AddZero(b.getHours()),utility.AddZero(b.getMinutes())].join(":"),b.getHours()>=12?"PM":"AM"].join(" "),g=$("<td>"),h=$("<td>"),i=$("<td>"),j=$("<td>"),k=$("<td>"),m=$("#saveGameTable > tbody"),n=$("#loadGameTable > tbody"),l=$("#saveGameId").val(),e=""!=(""+l).trim()?l:"auto_"+Math.floor(1e4*Math.random()+1),o=$('<button class="btn btn-mini deletesave" type="button">X</button>');$("#saveloadingimg").css("display","inline"),$.ajax({type:"POST",url:"/Account/SudokuService.asmx/SaveGame",data:JSON.stringify({token:board.userToken,gameId:$("#IdLiteral").text(),saveId:e,saveTimeStamp:f,saveData:JSON.stringify(board.array_data),movesHistory:JSON.stringify(board.movesHistory)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){m.append(d),n.append(a),a.css("cursor","pointer"),g.text(e),d.append(g),j.text(e),a.append(j),a.data("MovesHistory",JSON.stringify(board.movesHistory)),a.data("SaveData",JSON.stringify(board.array_data)),h.text(f),d.append(h),k.text(f),a.append(k),i.append(o),d.append(i),$("#saveGameId").val(""),c.alertMessage("Game Saved Successfully with the name : "+e),c.numberOfSaves--,options.spans.remainingSaves.text(c.numberOfSaves),options.toggleSaveButton(),options.toggleLoadButton(),options.modals.hide(options.modals.save),$("#saveloadingimg").css("display","none")},error:function(b,a){c.alertMessage("Error:"+a),options.modals.hide(options.modals.save),$("#saveloadingimg").css("display","none")}})},bindLoadClicks:function(){var a=board;$("#loadGameTable > tbody >tr").each(function(){$(this).off(),$(this).on("click",function(){var b=$(this).find("td:eq(0)"),c=b.text(),d=b.parents("tr").data("SaveData"),e=b.parents("tr").data("MovesHistory");a.load(e,d),options.modals.hide(options.modals.load),a.alertMessage("Save Id : ("+c+") has been successfully loaded")})})},highlightnum:function(){var a=board,d=$(this).text();if("X"!=d){a.removeHighlight();for(var b=0;9>b;b++)for(var c=0;9>c;c++)a.array_data[b][c].value==d&&a.highlightCell(b,c)}else a.removeHighlight()}},board={string_data:null,array_data:[],mainboard:null,notemode:null,allcandidatesmode:null,selectedPosI:null,selectedPosJ:null,selectedBlockI:null,selectedBlockJ:null,easymode:null,userToken:null,movesHistory:[],MaxSavesAllowed:5,numberOfSaves:null,emptyCellsCount:null,init:function(a,b){this.timer=new Timer,this.mainboard=$("#playtable"),this.string_data=a,this.array_data=this.transformToArray(a),this.notemode=false,this.allcandidatesmode=false,this.easymode=false,this.userToken=""!=b?b:null,$("#loaderstatus").text(texts.loading_calculating),this.setInitialValues(),this.initiateHandlers(),this.selectBox.init(),this.writeConsole(),this.toggleUndoButton(),this.toggleCandidatesTables(),this.timer.init($("#gametime")),this.timer.go(),options.bind_options()},restart:function(){for(var d,a=this,e=[],b=0;9>b;b++){d=[];for(var c=0;9>c;c++)d.push({value:a.string_data[c+9*b],possibilities:a.array_data[b][c].originalPossibilities,originalPossibilities:a.array_data[b][c].originalPossibilities,isfixed:a.array_data[b][c].isfixed});e.push(d)}a.array_data=e,a.removeHighlight(),a.selectBox.hide(),$("#playtable").find("span.varcell").text("").removeClass("hide"),$("#playtable").find("table.candidates").removeClass("shown"),a.timer.restart(),a.movesHistory=[],a.toggleUndoButton(),a.writeHistoryConsole(),a.writeConsole()},load:function(k,l){var a=this;a.array_data=JSON.parse(l),a.movesHistory=JSON.parse(k);for(var g,d,e,h,f,b=0;9>b;b++)for(var c=0;9>c;c++)if(1!=a.array_data[b][c].isfixed)if(g=a.findCell(b,c),d=g.children("span.varcell"),e=g.children("table.candidates"),"?"!=a.array_data[b][c].value)d.removeClass("hide"),d.text(0!=a.array_data[b][c].value?a.array_data[b][c].value:""),e.removeClass("shown"),e.find("tbody > tr>td").each(function(){$(this).text("")});else{d.addClass("hide"),d.text(""),e.addClass("shown"),f=0;for(var i=1;4>i;i++)for(var j=1;4>j;j++)f++,h=e.find("tbody > tr:nth-child("+i+") > td:nth-child("+j+")"),-1!=a.array_data[b][c].notes.indexOf(""+f)?h.text(f):h.text("")}a.removeHighlight(),a.selectBox.hide(),a.allcandidatesmode&&($(".shallowcandidates").remove(),a.toggleCandidatesTables()),a.toggleUndoButton(),a.writeHistoryConsole(),a.writeConsole()},countEmptyCells:function(){for(var d=board,c=0,a=0;9>a;a++)for(var b=0;9>b;b++)"0"==d.array_data[a][b].value&&c++;return c},transformToArray:function(g){for(var a,d=[],e=[],f=[],b=0;9>b;b++){a=[];for(var c=0;9>c;c++)e=[],f=[],a.push({value:g[c+9*b],possibilities:e,originalPossibilities:f,isfixed:false,notes:[]});d.push(a)}return d},makeTable:function(){var b,d,c,e,a=$("<table>");for(a.attr("cellpadding",0).attr("cellspacing",0),a.addClass("candidates"),b=0;3>b;b++)for(d=$("<tr>").appendTo(a),c=1;4>c;c++)e=$("<td>"),d.append(e);return a},makeShallowTable:function(){var b,e,c,d,a=$("<table>");for(a.attr("cellpadding",0).attr("cellspacing",0),a.addClass("shallowcandidates"),b=0;3>b;b++)for(e=$("<tr>").appendTo(a),c=1;4>c;c++)d=$("<td>"),d.text(3*b+c),e.append(d);return a},toggleCandidatesTables:function(){var a=board;a.allcandidatesmode?$("#playtable>tbody>tr>td").has("span.varcell").each(function(){var f=a.makeShallowTable(),g=$(this).data("i"),h=$(this).data("j");a.findCell(g,h);var b=a.array_data[g][h];if("0"==b.value||"?"==b.value){for(var c=0,d=1;4>d;d++)for(var e=1;4>e;e++)c++,$cell=f.find("tbody > tr:nth-child("+d+") > td:nth-child("+e+")"),-1!=b.possibilities.indexOf(c)?$cell.text(c):$cell.text("");$(this).prepend(f)}}):$(".shallowcandidates").remove()},setInitialValues:function(){for(var c,e=$("<span>").attr("class","fixedcell"),f=$("<span>").attr("class","varcell").text(""),a=0;9>a;a++)for(var b=0;9>b;b++)if("0"==this.array_data[a][b].value){f=$("<span>").attr("class","varcell").text(""),c=$("#playtable tr:eq("+a+") td:eq("+b+")"),c.empty().append(f),c.data("i",a),c.data("j",b),c.data("blockI",3*Math.floor(a/3)),c.data("blockJ",3*Math.floor(b/3)),c.attr("data-toggle","context"),c.attr("data-target","#context-menu"),this.array_data[a][b].isfixed=false;for(var d=1;10>d;d++)board.valueIsInRow(a,d)||board.valueIsInColumn(b,d)||board.valueIsInBlock(a,b,d)||(this.array_data[a][b].possibilities.push(d),this.array_data[a][b].originalPossibilities.push(d))}else e=$("<span>").attr("class","fixedcell"),e.text(this.array_data[a][b].value),$("#playtable tr:eq("+a+") td:eq("+b+")").empty().append(e),this.array_data[a][b].isfixed=true,this.array_data[a][b].possibilities.push("-"),this.array_data[a][b].originalPossibilities.push("-");$("#playtable").children("tbody").children("tr").children("td").children("span.varcell").parent().append(board.makeTable())},recreatePossibilities:function(){for(var a=board,b=0;9>b;b++)for(var c=0;9>c;c++)if(!a.array_data[b][c].isfixed){a.array_data[b][c].possibilities=[];for(var d=1;10>d;d++)a.valueIsInRow(b,d)||a.valueIsInColumn(c,d)||a.valueIsInBlock(b,c,d)||this.array_data[b][c].possibilities.push(d)}a.allcandidatesmode&&$("#playtable>tbody>tr>td").has("span.varcell").each(function(){var b=$(this).find(".shallowcandidates"),g=$(this).data("i"),h=$(this).data("j");a.findCell(g,h);var c=a.array_data[g][h];if(0==c.value||"?"==c.value){var d=0,i=false;0==b.length&&(b=a.makeShallowTable(),i=true);for(var e=1;4>e;e++)for(var f=1;4>f;f++)d++,$cell=b.find("tbody > tr:nth-child("+e+") > td:nth-child("+f+")"),-1!=c.possibilities.indexOf(d)?$cell.text(d):$cell.text("");i&&$(this).prepend(b)}else b.remove()})},initiateHandlers:function(){var a=board;$("span.varcell").parent("td").on("click",a.cellClick)},selectBox:function(){function e(){a=board;var b,g,c,e,f=$("<table>");for(f.attr("cellpadding",0).attr("cellspacing",0),f.addClass("num_select"),b=0;3>b;b++)for(g=$("<tr>").appendTo(f),c=1;4>c;c++)e=$("<td>"),e.text(3*b+c),e.data("value",3*b+c),g.append(e),e.on("click",h);this.obj=f,d=false}function f(b){g(b),a.selectBox.obj.addClass("show"),$(b).prepend(a.selectBox.obj),a.selectBox.isShown=true,setTimeout(function(){$(document).on("click",c)},20)}function b(){a.selectBox.obj.removeClass("show"),a.selectBox.isShown=false,$(document).off("click",c)}function c(c){var a=$(c.target),d=a.hasClass("num_select")||a.parents("table").hasClass("num_select");return d?false:(b(),void 0)}function g(f){var g=a.selectBox.obj;if(!a.easymode)return g.find("td").removeClass("disabled"),void 0;for(var c,b,h=$(f).data("i"),i=$(f).data("j"),j=a.array_data[h][i].possibilities,d=1;4>d;d++)for(var e=1;4>e;e++)b=g.find("tbody > tr:nth-child("+d+") > td:nth-child("+e+")"),c=b.data("value"),-1==j.indexOf(c)?b.addClass("disabled"):b.removeClass("disabled"),a.array_data[h][i].value==c&&b.removeClass("disabled")}function h(a){var b=board;if(!$(a.target).hasClass("disabled")&&b.selectBox.isShown){var b=board,c=a.target.innerHTML;a.stopPropagation();var d=$(a.target).parents("td.cellnormal").data("i"),e=$(a.target).parents("td.cellnormal").data("j");board.changeCell(a,d,e,c),b.recreatePossibilities(),b.writeConsole(),board.selectBox.hide()}}var a,d;return{init:e,show:f,hide:b,isShown:d}}(),cellClick:function(b){var a=board;a.selectBox.isShown&&a.selectBox.hide(),"A"!=b.target.tagName&&(a.removeHighlight(),a.selectBox.show(b.currentTarget))},changeCell:function(f,b,c,d){var a=board,e=a.findCell(b,c);e.children("span.varcell"),e.children("table.candidates"),a.array_data[b][c].possibilities,a.array_data[b][c].originalPossibilities,1==a.notemode?a.changeNote(b,c,d):a.changeVarCell(b,c,d)},changeVarCell:function(a,b,c){var d=board,g=d.findCell(a,b),e=g.children("span.varcell"),f=g.children("table.candidates");if(f.hasClass("shown")){f.removeClass("shown"),d.changeNotesArray(a,b),e.hasClass("hide")&&e.removeClass("hide");var h=[];f.find("tbody > tr>td").each(function(){""!=$(this).text()&&(h.push($(this).text()),$(this).text(""))}),e.text(c),d.changeArrayData(a,b,c),d.addToHistory(a,b,h,[c],"note")}else e.text()==c?(e.text(""),d.changeArrayData(a,b,0),d.addToHistory(a,b,[c],[e.text()],"varcell")):(d.changeArrayData(a,b,c),d.addToHistory(a,b,[e.text()],[c],"varcell"),e.text(c))},changeNote:function(a,b,d){var c=board,n=c.findCell(a,b),h=n.children("span.varcell"),i=n.children("table.candidates");if(h.hasClass("hide")){var j,k;3>=d?(j=1,k=d):6>=d?(j=2,k=d-3):(j=3,k=d-6);var g=i.find("tbody > tr:nth-child("+j+") > td:nth-child("+k+")"),f=[];if(i.find("tbody > tr>td").each(function(){""!=$(this).text()&&f.push($(this).text())}),""==g.text())g.text(d),c.addToHistory(a,b,f,[f,d],"note"),c.changeArrayData(a,b,"?"),c.changeNotesArray(a,b);else{g.text("");for(var m=[],e=0;f.length>e;e++)f[e]!=d&&m.push(f[e]);c.addToHistory(a,b,f,m,"note"),0==m.length?(c.changeArrayData(a,b,0),c.changeNotesArray(a,b)):(c.changeArrayData(a,b,"?"),c.changeNotesArray(a,b))}}else{h.addClass("hide"),c.addToHistory(a,b,[h.text()],[d],"varcell"),c.changeArrayData(a,b,"?");for(var g,o=0,e=1;4>e;e++)for(var l=1;4>l;l++)o++,g=i.find("tbody > tr:nth-child("+e+") > td:nth-child("+l+")"),o==d?g.text(d):g.text("");i.addClass("shown"),h.text(""),c.changeNotesArray(a,b)}},changeNotesArray:function(b,c){var a=board,h=a.findCell(b,c),d=[],g=h.children("table.candidates"),i=0;if(!g.hasClass("shown"))return a.array_data[b][c].notes=d,a.writeConsole(),void 0;for(var e=1;4>e;e++)for(var f=1;4>f;f++)i++,$cell=g.find("tbody > tr:nth-child("+e+") > td:nth-child("+f+")"),""!=$cell.text()&&d.push($cell.text());a.array_data[b][c].notes=d,a.writeConsole()},changePossibilities:function(f,b,h,i){var a=board,c=a.array_data[f][b].possibilities,g=a.array_data[f][b].originalPossibilities,e=parseInt(h);switch(i){case"remove":for(var d=0;9>d;d++)g=a.array_data[d][b].originalPossibilities,c=a.array_data[d][b].possibilities,-1!=g.indexOf(e)&&-1!=c.indexOf(e)&&c.splice(c.indexOf(e),1)}a.writeConsole()},noteModeClick:function(c,a){that=board;var b=($(a.el),a.value);that.notemode=b,0==b&&that.noteModeOff()},easyModeClick:function(c,a){that=board;var b=($(a.el),a.value);that.easymode=b},allCandidatesModeClick:function(c,a){that=board;var b=($(a.el),a.value);that.allcandidatesmode=b,that.toggleCandidatesTables()},findCell:function(a,b){a+=1,b+=1;var c=board.mainboard.find("tbody > tr:nth-child("+a+") > td.cellnormal:nth-child("+b+")");return c},highlightCell:function(a,b){var c=board;c.findCell(a,b).addClass("cellhighlighted")},highlightSimilarCells:function(e,f){var a=board;a.removeHighlight();var d=a.findCell(e,f).find("span.varcell").text();if(""==d)return a.alertMessage("Nothing to highlight"),void 0;for(var b=0;9>b;b++)for(var c=0;9>c;c++)a.findCell(b,c).find("span").text()==d&&a.findCell(b,c).addClass("cellhighlighted")},highlightBlock:function(){for(var c=board,a=board.selectedBlockI;board.selectedBlockI+3>a;a++)for(var b=board.selectedBlockJ;board.selectedBlockJ+3>b;b++)c.highlightCell(a,b)},removeHighlight:function(){for(var c=board,a=0;9>a;a++)for(var b=0;9>b;b++)c.findCell(a,b).removeClass("cellhighlighted")},getValue:function(b,c){var d=board,a=d.findCell(b,c).find(".varcell:visible").first().text();return""!=a?a:0},alertMessage:function(a){$(".alert-message").find("span").text(a),$(".alert-message").show(),setTimeout(function(){$(".alert-message").addClass("blink")},500),setTimeout(function(){$(".alert-message").removeClass("blink")},1e3)},writeConsole:function(){var d=$(".console"),f=$("<br/>"),e=$("<span>"),g=$("<hr/>"),c="";d.empty();for(var a=0;9>a;a++){e=$("<span>"),f=$("<br/>"),c="";for(var b=0;9>b;b++)c=c+board.array_data[a][b].value+" "+board.array_data[a][b].notes;e.text(c),d.append(e),d.append(f)}d.append(g),c="";for(var a=0;9>a;a++)for(var b=0;9>b;b++)e=$("<span>"),f=$("<br/>"),c=board.array_data[a][b].possibilities+" => "+board.array_data[a][b].originalPossibilities,e.text(c),d.append(e),d.append(f)},writeHistoryConsole:function(){},changeArrayData:function(a,b,c){board.array_data[a][b].value=c,board.writeConsole()},noteModeOff:function(){},clearCell:function(i,j){var a=board,f=a.findCell(i,j),b=f.children("span.varcell"),g=f.children("table.candidates");if(b.is(":visible"))return""==b.text()?a.alertMessage("Cell is empty .. Nothing to clear"):(a.changeArrayData(a.selectedPosI,a.selectedPosJ,0),a.addToHistory(a.selectedPosI,a.selectedPosJ,[b.text()],[""],"varcell"),b.text(""),a.alertMessage("Cell is cleared"),a.recreatePossibilities(),a.writeConsole(),a.writeHistoryConsole()),void 0;for(var c,h=[],d=1;4>d;d++)for(var e=1;4>e;e++)c=g.find("tbody > tr:nth-child("+d+") > td:nth-child("+e+")"),""!=c.text()&&h.push(c.text()),c.text("");g.removeClass("shown"),b.removeClass("hide"),a.addToHistory(a.selectedPosI,a.selectedPosJ,h,[""],"note"),a.changeArrayData(a.selectedPosI,a.selectedPosJ,0),a.changeNotesArray(a.selectedPosI,a.selectedPosJ),a.recreatePossibilities(),a.writeConsole(),a.writeHistoryConsole()},valueIsInRow:function(b,c){for(var d=board,a=0;9>a;a++)if(d.array_data[b][a].value==c)return true;return false},valueIsInColumn:function(b,c){for(var d=board,a=0;9>a;a++)if(d.array_data[a][b].value==c)return true;return false},valueIsInBlock:function(e,f,g){for(var h=board,c=3*Math.floor(e/3),d=3*Math.floor(f/3),a=c;c+3>a;a++)for(var b=d;d+3>b;b++)if(h.array_data[a][b].value==g)return true;return false},toggleUndoButton:function(){var a=board;0==a.movesHistory.length?options.buttons.set(options.buttons.undo,false):options.buttons.set(options.buttons.undo,true)},addToHistory:function(b,c,d,e,f){var a=board;a.movesHistory.push({posI:b,posJ:c,oldvalues:d,newvalues:e,type:f}),a.toggleUndoButton(),a.writeHistoryConsole()},undo:function(){var a=board;if(!$(this).hasClass("disabled")){var b=a.movesHistory.pop(),d=b.posI,e=b.posJ,f=b.oldvalues,l=(b.newvalues,b.type),c=a.findCell(d,e),g=c.find("span.varcell"),h=c.find("table.candidates");if("varcell"==l)g.text(f[0]),g.removeClass("hide"),h.removeClass("shown"),a.changeArrayData(d,e,""==f[0]?0:f[0]);else{g.text(""),g.addClass("hide");for(var i=0,j=1;4>j;j++)for(var k=1;4>k;k++)i++,c=h.find("tbody > tr:nth-child("+j+") > td:nth-child("+k+")"),-1!=f.indexOf(""+i)?c.text(i):c.text("");h.addClass("shown"),a.changeArrayData(d,e,"?")}a.changeNotesArray(d,e),a.recreatePossibilities(),a.writeHistoryConsole(),a.writeConsole(),a.toggleUndoButton(),a.alertMessage(texts.undo+": Step("+parseInt(a.movesHistory.length+1)+")")}},hint:function(){var a=board,d=0;a.removeHighlight();for(var b=0;9>b;b++)for(var c=0;9>c;c++)1!=a.array_data[b][c].possibilities.length||a.array_data[b][c].isfixed||0!=a.array_data[b][c].value||(a.highlightCell(b,c),d++);0==d&&a.alertMessage("No Visible Hints !!!")},checkSolution:function(e,f){var a=board;a.removeHighlight();var d;if(e||f){if(d=a.array_data[e][f].value,alert(d),0==d||"?"==d)return a.alertMessage("No value to check !!!"),void 0;for(var g=0;9>g;g++)if(g!=e&&d==a.array_data[g][f].value)return a.alertMessage("Error : Elements cannot have similar values within same Column !!"),a.highlightCell(g,f),a.highlightCell(e,f),void 0;for(var h=0;9>h;h++)if(h!=f&&d==a.array_data[e][h].value)return a.alertMessage("Error : Elements cannot have similar values within same Row !!"),a.highlightCell(e,h),a.highlightCell(e,f),void 0;for(var k=3*Math.floor(e/3),l=3*Math.floor(f/3),i=k;k+3>i;i++)for(var j=l;l+3>j;j++)if((e!=i||f!=j)&&d==a.array_data[i][j].value)return a.alertMessage("Error : Elements cannot have similar values within same Block !!"),a.highlightCell(i,j),a.highlightCell(e,f),void 0}else for(var b=0;9>b;b++)for(var c=0;9>c;c++)if(!a.array_data[b][c].isfixed&&0!=a.array_data[b][c].value&&"?"!=a.array_data[b][c].value){d=a.array_data[b][c].value;for(var g=0;9>g;g++)if(g!=b&&d==a.array_data[g][c].value)return a.alertMessage("Error : Elements cannot have similar values within same Column !!"),a.highlightCell(g,c),a.highlightCell(b,c),void 0;for(var h=0;9>h;h++)if(h!=c&&d==a.array_data[b][h].value)return a.alertMessage("Error : Elements cannot have similar values within same Row !!"),a.highlightCell(b,h),a.highlightCell(b,c),void 0;for(var k=3*Math.floor(b/3),l=3*Math.floor(c/3),i=k;k+3>i;i++)for(var j=l;l+3>j;j++)if((b!=i||c!=j)&&d==a.array_data[i][j].value)return a.alertMessage("Error : Elements cannot have similar values within same Block !!"),a.highlightCell(i,j),a.highlightCell(b,c),void 0}a.alertMessage("No Visible Mistakes :)")},saveGame:function(){},showCandidates:function(){}},utility={supports_html5_storage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return false}},AddZero:function(a){return a>=0&&10>a?"0"+a:a+""},isObjectEmpty:function(b){var a=true;for(keys in b){a=false;break}return a}}